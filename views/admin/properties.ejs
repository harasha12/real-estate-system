<!DOCTYPE html>
<html>
<head>
  <title>Properties</title>
  <style>
    :root{
      --bg:#f1f5f9;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#64748b;
      --border:#e2e8f0;
      --primary:#2563eb;
      --success:#16a34a;
      --warning:#f59e0b;
      --danger:#dc2626;
    }

    *{ box-sizing:border-box; }

    body {
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background:
        radial-gradient(circle at 0% 0%, #bfdbfe 0, transparent 55%),
        radial-gradient(circle at 100% 100%, #fee2e2 0, transparent 55%),
        var(--bg);
      color:var(--ink);
    }

    h2{
      text-align:center;
      margin:24px 0 10px;
      font-size:24px;
      font-weight:600;
    }

    .subtitle{
      text-align:center;
      font-size:13px;
      color:var(--muted);
      margin-bottom:18px;
    }

    .container {
      width:90%;
      max-width:1000px;
      margin:0 auto 30px;
    }

    .card {
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:20px;
      background:var(--card);
      margin:14px 0;
      padding:16px 18px;
      border-radius:16px;
      box-shadow:0 14px 32px rgba(15,23,42,0.12);
      border:1px solid var(--border);
      transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
    }

    .card:hover{
      transform:translateY(-3px);
      box-shadow:0 20px 40px rgba(15,23,42,0.18);
      border-color:#bfdbfe;
    }

    .details {
      width:65%;
      min-width:0;
    }

    .details p {
      margin:5px 0;
      font-size:14px;
      color:var(--muted);
    }

    .details b{
      color:var(--ink);
    }

    .price-row{
      display:flex;
      flex-wrap:wrap;
      gap:14px;
      margin:6px 0 4px;
    }

    .price-item{
      font-size:13px;
      color:var(--muted);
    }

    .price-item span{
      font-weight:600;
      color:var(--ink);
    }

    .status-pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 10px;
      border-radius:999px;
      font-size:11px;
      font-weight:600;
    }

    .status-available{
      background:rgba(22,163,74,0.10);
      color:var(--success);
      border:1px solid rgba(22,163,74,0.6);
    }

    .status-hold{
      background:rgba(245,158,11,0.10);
      color:var(--warning);
      border:1px solid rgba(245,158,11,0.6);
    }

    .status-sold{
      background:rgba(248,113,113,0.10);
      color:var(--danger);
      border:1px solid rgba(248,113,113,0.7);
    }

    .details a {
      display:inline-block;
      margin-top:10px;
      padding:9px 14px;
      background:linear-gradient(135deg,var(--primary),#1d4ed8);
      color:white;
      text-decoration:none;
      border-radius:999px;
      font-size:13px;
      font-weight:600;
      box-shadow:0 12px 24px rgba(37,99,235,0.35);
      transition:transform .18s, box-shadow .18s, background .18s;
    }

    .details a:hover{
      transform:translateY(-1px);
      box-shadow:0 16px 32px rgba(37,99,235,0.45);
      background:linear-gradient(135deg,#1d4ed8,#1e40af);
    }

    .image-box {
      width:30%;
      text-align:right;
    }

    .image-box img {
      width:260px;
      max-width:100%;
      height:160px;
      object-fit:cover;
      border-radius:12px;
      cursor:pointer;
      border:1px solid var(--border);
      box-shadow:0 10px 24px rgba(15,23,42,0.22);
      transition:transform .2s ease, box-shadow .2s ease;
    }

    .image-box img:hover{
      transform:scale(1.03);
      box-shadow:0 16px 34px rgba(15,23,42,0.26);
    }

    /* POPUP */
    .popup {
      display:none;
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background:rgba(15,23,42,0.92);
      justify-content:center;
      align-items:center;
      z-index:1000;
    }

    .popup img {
      max-width:90%;
      max-height:90%;
      border-radius:12px;
      box-shadow:0 24px 60px rgba(0,0,0,0.6);
    }

    .popup-close{
      position:fixed;
      top:16px;
      right:24px;
      color:#e5e7eb;
      font-size:26px;
      cursor:pointer;
      font-weight:bold;
    }

    @media(max-width:768px){
      .card{
        flex-direction:column-reverse;
        align-items:flex-start;
      }
      .details, .image-box{
        width:100%;
      }
      .image-box{
        text-align:left;
      }
      .image-box img{
        width:100%;
        height:190px;
      }
    }
  </style>
</head>
<body>

<h2>Available Properties</h2>
<div class="subtitle">Browse verified listings with latest pricing and status</div>

<div class="container">
<% properties.forEach(p => { %>

  <div class="card">
    <!-- LEFT SIDE DETAILS -->
    <div class="details">
      <p><b>Type:</b> <%= p.type %></p>
      <p><b>Location:</b> <%= p.location %></p>
      <p><b>Area:</b> <%= p.area_size %></p>

      <div class="price-row">
        <div class="price-item">
          Market Value: <span>₹ <%= p.market_amount || "N/A" %></span>
        </div>
        <div class="price-item">
          Govt Value: <span>₹ <%= p.govt_amount || "N/A" %></span>
        </div>
        <div class="price-item">
          Final Price: <span>₹ <%= p.final_amount || "N/A" %></span>
        </div>
      </div>

      <p>
        <b>Status:</b>
        <% if(p.booking_status === 'available') { %>
          <span class="status-pill status-available">● Available</span>
        <% } else if(p.booking_status === 'hold') { %>
          <span class="status-pill status-hold">● On Hold</span>
        <% } else { %>
          <span class="status-pill status-sold">● Sold</span>
        <% } %>
      </p>

      <a href="/property/<%= p.id %>">View property details</a>
    </div>

    <!-- RIGHT SIDE IMAGE -->
    <div class="image-box">
      <img
        src="<%= p.main_image ? '/uploads/properties/' + p.main_image : 'https://via.placeholder.com/260x160' %>"
        onclick="openPopup(this.src)"
        alt="Property image"
      >
    </div>
  </div>

<% }) %>
</div>

<!-- IMAGE POPUP -->
<div id="popup" class="popup" onclick="closePopup()">
  <span class="popup-close">&times;</span>
  <img id="popupImg" alt="Preview">
</div>

<script>
  function openPopup(src) {
    document.getElementById("popupImg").src = src;
    document.getElementById("popup").style.display = "flex";
  }

  function closePopup() {
    document.getElementById("popup").style.display = "none";
  }
</script>

</body>
</html>